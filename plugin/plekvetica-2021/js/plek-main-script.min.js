let plek_main={construct(){jQuery(window).resize(),jQuery(document).ready(function(){plek_main.add_event_listener()})},activate_button_loader(e,r){this.activate_loader_style(e),jQuery(e).is("input")?jQuery(e).val(r):jQuery(e).html(r)},deactivate_button_loader(e,r){this.deactivate_loader_style(e),jQuery(e).is("input")?jQuery(e).val(r):jQuery(e).html(r)},deactivate_button(e){jQuery(e).off("click"),jQuery(e).addClass("deactivate"),jQuery(e).prop("disabled",!0)},disable_button(e){jQuery(e).addClass("disable")},activate_loader_style(e){jQuery(e).addClass("loader")},deactivate_loader_style(e){jQuery(e).removeClass("loader")},get_text_from_ajax_request(e,r=!1){try{let t=JSON.parse(e),a="";return t.success.length>0&&(a+=t.success),r?a:(t.error.length>0&&(a+=0===a.length?"":"<br/>",a+="Error: "+t.error),t.system_error.length>0&&(a+=0===a.length?"":"<br/>",a+="Error: "+t.system_error),a)}catch(r){return e}},add_event_listener(){jQuery("#main").on("click",".ajax-loader-button",function(e){e.preventDefault(),plek_main.load_block(this)})},get_ajax_success_object(e){try{let r=JSON.parse(e);if(r.success.length>0)return r.success}catch(r){return e}},get_first_error_from_ajax_request(e){try{let r=JSON.parse(e),t="";return r.error.length>0&&(t+=r.error[0]),t}catch(r){return e}},response_has_errors(e){try{var r=e;return"object"!=typeof e&&(r=JSON.parse(e)),0!==r.error.length}catch(e){return console.log(e),!1}},show_field_errors(e,r="form"){let t=0;try{var a=e;"object"!=typeof e&&(a=JSON.parse(e));for(const[e,o]of Object.entries(a.error)){if("object"==typeof o)for(const[e,a]of Object.entries(o))jQuery(a).each(function(o){console.log("set "+e);if(0===(l=jQuery("#"+e)).length)var l=jQuery(r);jQuery(l).after(plek_main.format_error_message(a[o])),t++});"string"==typeof o&&(jQuery(r).after(plek_main.format_error_message(o)),console.log("not assigned"),console.log(r)),jQuery(o).each(function(r){jQuery("#"+e).after(plek_main.format_error_message(o[r])),t++})}return 0!==t}catch(e){return console.log(e),!1}},remove_field_errors(){jQuery(".plek-field-error").remove()},format_error_message:e=>`<span class="plek-error plek-field-error">${e}</span>`,load_block(e){let r=jQuery(e).closest(".block-container");plek_main.remove_field_errors(),plek_main.activate_loader_style(e);var t=new FormData;t.append("action","plek_event_actions"),t.append("do","load_block_content"),t=plek_main.get_block_data(r,t,e),t=plek_main.get_url_query_data(t),jQuery.ajax({url:window.ajaxurl,type:"POST",cache:!1,processData:!1,contentType:!1,data:t,success:function(a){plek_main.deactivate_loader_style(e);let o=plek_main.get_text_from_ajax_request(a,!0);if(!0===plek_main.response_has_errors(a))console.log("Contains Errors"),o=plek_main.get_first_error_from_ajax_request(a);else{jQuery(r).replaceWith(o);let e=t.get("paged");e&&window.history.pushState({},"Page",plek_main.url_add_page(e))}jQuery(e).text(o)},error:function(r){plek_main.deactivate_loader_style(e),jQuery(e).text("Error loading data....")}})},get_block_data(e,r,t){for(const[t,a]of Object.entries(jQuery(e).data()))"paged"!==t&&r.append(t,a);return r.append("paged",jQuery(t).data("paged")),r},get_url_query_data(e){let r=new URLSearchParams(window.location.search);return jQuery(["order","direction"]).each(function(t,a){let o=r.get(a);null!==o&&o.length>0&&e.append(a,o)}),e},url_add_page(e){let r=window.location.pathname,t="";return t=r.search("page/")>0?r.replace(/(page\/[0-9]+)/,"page/"+e):(t=r+"/page/"+e).replace("//","/",r+"/page/"+e)}};plek_main.construct();